[tox]
envlist = bandit,black,lint,py39
isolated_build = True

[testenv]
basepython = python3.9
# Set RPM_PY_VERBOSE to "true" to debug koji package installation failures
passenv = RPM_PY_VERBOSE
extras =
    test
commands =
    pytest \
        --cov-reset \
        --cov=product_listings_manager \
        --cov-report=term-missing \
        --cov-report=xml \
        --cov-report=html \
        {posargs}

[testenv:bandit]
skip_install = true
deps =
    bandit
commands =
    bandit --recursive product-listings-manager

[testenv:lint]
commands =
    python -m flake8 {posargs}

[testenv:black]
skip_install = true
deps =
    black
commands =
    black --check --diff {toxinidir}

[testenv:black-format]
skip_install = true
deps =
    black
commands =
    black {toxinidir}

[flake8]
show-source = True
exclude = .git,.tox,dist,*egg,.env,.venv,config.py
ignore = E501,W503
